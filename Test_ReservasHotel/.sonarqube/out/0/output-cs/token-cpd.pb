ˇ
iD:\ESPE\SEXTO SEMESTRE\Pruebas Software\Parcial2\Programas\ReservasHotel\ReservasHotel\WeatherForecast.cs
	namespace 	
ReservasHotel
 
{ 
public 

class 
WeatherForecast  
{ 
public 
DateOnly 
Date 
{ 
get "
;" #
set$ '
;' (
}) *
public 
int 
TemperatureC 
{  !
get" %
;% &
set' *
;* +
}, -
public		 
int		 
TemperatureF		 
=>		  "
$num		# %
+		& '
(		( )
int		) ,
)		, -
(		- .
TemperatureC		. :
/		; <
$num		= C
)		C D
;		D E
public 
string 
? 
Summary 
{  
get! $
;$ %
set& )
;) *
}+ ,
} 
} ≤
aD:\ESPE\SEXTO SEMESTRE\Pruebas Software\Parcial2\Programas\ReservasHotel\ReservasHotel\Program.cs
	namespace 	
ReservasHotel
 
{ 
public 

static 
class 
Program 
{ 
public 
static 
void 
Main 
(  
string  &
[& '
]' (
args) -
)- .
{		 	
	DotNetEnv

 
.

 
Env

 
.

 
Load

 
(

 
)

  
;

  !
var 
builder 
= 
WebApplication (
.( )
CreateBuilder) 6
(6 7
args7 ;
); <
;< =
builder 
. 
Services 
. 
AddControllers +
(+ ,
), -
;- .
builder 
. 
Services 
. #
AddEndpointsApiExplorer 4
(4 5
)5 6
;6 7
builder 
. 
Services 
. 
AddSwaggerGen *
(* +
)+ ,
;, -
var 
connectionString  
=! "
Environment# .
.. /"
GetEnvironmentVariable/ E
(E F
$strF Y
)Y Z
;Z [
if 
( 
string 
. 
IsNullOrEmpty $
($ %
connectionString% 5
)5 6
)6 7
{ 
throw 
new %
InvalidOperationException 3
(3 4
$str4 s
)s t
;t u
} 
builder 
. 
Services 
. 
AddDbContext )
<) *
AppDBContext* 6
>6 7
(7 8
options8 ?
=>@ B
options 
. 
UseSqlServer $
($ %
connectionString% 5
)5 6
)6 7
;7 8
var   
app   
=   
builder   
.   
Build   #
(  # $
)  $ %
;  % &
if## 
(## 
app## 
.## 
Environment## 
.##  
IsDevelopment##  -
(##- .
)##. /
)##/ 0
{$$ 
app%% 
.%% 

UseSwagger%% 
(%% 
)%%  
;%%  !
app&& 
.&& 
UseSwaggerUI&&  
(&&  !
)&&! "
;&&" #
}'' 
app)) 
.)) 
UseHttpsRedirection)) #
())# $
)))$ %
;))% &
app++ 
.++ 
UseAuthorization++  
(++  !
)++! "
;++" #
app.. 
... 
MapControllers.. 
(.. 
)..  
;..  !
app00 
.00 
Run00 
(00 
)00 
;00 
}11 	
}22 
}33 ¨˛
~D:\ESPE\SEXTO SEMESTRE\Pruebas Software\Parcial2\Programas\ReservasHotel\ReservasHotel\Controllers\ReservasHotel.Controller.cs
	namespace 	
ReservasHotel
 
. 
Controllers #
{ 
[ 
ApiController 
] 
[		 
Route		 

(		
 
$str		 
)		 
]		 
public

 

class

 
ClientesController

 #
:

$ %
ControllerBase

& 4
{ 
private 
readonly 
AppDBContext %
_appDBcontext& 3
;3 4
public 
ClientesController !
(! "
AppDBContext" .
appDBcontext/ ;
); <
{ 	
_appDBcontext 
= 
appDBcontext (
;( )
} 	
[ 	
HttpGet	 
] 
public 
async 
Task 
< 
IActionResult '
>' (
GetClientes) 4
(4 5
)5 6
{ 	
var 
clientes 
= 
await  
_appDBcontext! .
.. /
Clientes/ 7
.7 8
ToListAsync8 C
(C D
)D E
;E F
return 
Ok 
( 
clientes 
) 
;  
} 	
[ 	
HttpGet	 
( 
$str 
) 
] 
public 
async 
Task 
< 
ActionResult &
<& '
AppDBContext' 3
.3 4
Cliente4 ;
>; <
>< =

GetCliente> H
(H I
intI L
idM O
)O P
{ 	
var 
cliente 
= 
await 
_appDBcontext  -
.- .
Clientes. 6
.6 7
	FindAsync7 @
(@ A
idA C
)C D
;D E
if 
( 
cliente 
== 
null 
)  
return! '
NotFound( 0
(0 1
)1 2
;2 3
return 
cliente 
; 
}   	
["" 	
HttpPost""	 
]"" 
public## 
async## 
Task## 
<## 
ActionResult## &
<##& '
AppDBContext##' 3
.##3 4
Cliente##4 ;
>##; <
>##< =
PostCliente##> I
(##I J
AppDBContext##J V
.##V W
Cliente##W ^
cliente##_ f
)##f g
{$$ 	
_appDBcontext%% 
.%% 
Clientes%% "
.%%" #
Add%%# &
(%%& '
cliente%%' .
)%%. /
;%%/ 0
await&& 
_appDBcontext&& 
.&&  
SaveChangesAsync&&  0
(&&0 1
)&&1 2
;&&2 3
return'' 
Ok'' 
('' 
cliente'' 
)'' 
;'' 
}(( 	
[** 	
HttpPut**	 
(** 
$str** 
)** 
]** 
public++ 
async++ 
Task++ 
<++ 
IActionResult++ '
>++' (

PutCliente++) 3
(++3 4
int++4 7
id++8 :
,++: ;
AppDBContext++< H
.++H I
Cliente++I P
cliente++Q X
)++X Y
{,, 	
var.. 
clienteExistente..  
=..! "
await..# (
_appDBcontext..) 6
...6 7
Clientes..7 ?
...? @
	FindAsync..@ I
(..I J
id..J L
)..L M
;..M N
if// 
(// 
clienteExistente//  
==//! #
null//$ (
)//( )
return//* 0
NotFound//1 9
(//9 :
$str//: Q
)//Q R
;//R S
clienteExistente11 
.11 
nombre11 #
=11$ %
cliente11& -
.11- .
nombre11. 4
;114 5
clienteExistente22 
.22 
apellido22 %
=22& '
cliente22( /
.22/ 0
apellido220 8
;228 9
clienteExistente33 
.33 
telefono33 %
=33& '
cliente33( /
.33/ 0
telefono330 8
;338 9
await66 
_appDBcontext66 
.66  
SaveChangesAsync66  0
(660 1
)661 2
;662 3
return77 
Ok77 
(77 
clienteExistente77 &
)77& '
;77' (
}88 	
[;; 	

HttpDelete;;	 
(;; 
$str;; 
);; 
];; 
public<< 
async<< 
Task<< 
<<< 
IActionResult<< '
><<' (
DeleteCliente<<) 6
(<<6 7
int<<7 :
id<<; =
)<<= >
{== 	
var>> 
cliente>> 
=>> 
await>> 
_appDBcontext>>  -
.>>- .
Clientes>>. 6
.>>6 7
	FindAsync>>7 @
(>>@ A
id>>A C
)>>C D
;>>D E
if?? 
(?? 
cliente?? 
==?? 
null?? 
)??  
return??! '
NotFound??( 0
(??0 1
)??1 2
;??2 3
_appDBcontextAA 
.AA 
ClientesAA "
.AA" #
RemoveAA# )
(AA) *
clienteAA* 1
)AA1 2
;AA2 3
awaitBB 
_appDBcontextBB 
.BB  
SaveChangesAsyncBB  0
(BB0 1
)BB1 2
;BB2 3
returnCC 
OkCC 
(CC 
$"CC 
$strCC +
{CC+ ,
clienteCC, 3
.CC3 4
nombreCC4 :
+CC; <
clienteCC= D
.CCD E
apellidoCCE M
}CCM N
"CCN O
)CCO P
;CCP Q
}DD 	
}EE 
[II 
ApiControllerII 
]II 
[JJ 
RouteJJ 

(JJ
 
$strJJ 
)JJ 
]JJ 
publicKK 

classKK "
HabitacionesControllerKK '
:KK( )
ControllerBaseKK* 8
{LL 
privateMM 
readonlyMM 
AppDBContextMM %
_appDBcontextMM& 3
;MM3 4
publicOO "
HabitacionesControllerOO %
(OO% &
AppDBContextOO& 2
contextOO3 :
)OO: ;
{PP 	
_appDBcontextQQ 
=QQ 
contextQQ #
;QQ# $
}RR 	
[TT 	
HttpGetTT	 
]TT 
publicUU 
asyncUU 
TaskUU 
<UU 
IActionResultUU '
>UU' (
GetHabitacionesUU) 8
(UU8 9
)UU9 :
{VV 	
varWW 
habitacionesWW 
=WW 
awaitWW $
_appDBcontextWW% 2
.WW2 3
HabitacionesWW3 ?
.WW? @
ToListAsyncWW@ K
(WWK L
)WWL M
;WWM N
returnXX 
OkXX 
(XX 
habitacionesXX "
)XX" #
;XX# $
}YY 	
[[[ 	
HttpGet[[	 
([[ 
$str[[ 
)[[ 
][[ 
public\\ 
async\\ 
Task\\ 
<\\ 
ActionResult\\ &
<\\& '
AppDBContext\\' 3
.\\3 4

Habitacion\\4 >
>\\> ?
>\\? @
GetHbitacion\\A M
(\\M N
int\\N Q
id\\R T
)\\T U
{]] 	
var^^ 

habitacion^^ 
=^^ 
await^^ "
_appDBcontext^^# 0
.^^0 1
Habitaciones^^1 =
.^^= >
	FindAsync^^> G
(^^G H
id^^H J
)^^J K
;^^K L
if__ 
(__ 

habitacion__ 
==__ 
null__ "
)__" #
return__$ *
NotFound__+ 3
(__3 4
)__4 5
;__5 6
return`` 

habitacion`` 
;`` 
}aa 	
[cc 	
HttpPostcc	 
]cc 
publicdd 
asyncdd 
Taskdd 
<dd 
ActionResultdd &
<dd& '
AppDBContextdd' 3
.dd3 4

Habitaciondd4 >
>dd> ?
>dd? @
PostHabitacionddA O
(ddO P
AppDBContextddP \
.dd\ ]

Habitaciondd] g

habitacionddh r
)ddr s
{ee 	
ifff 
(ff 

habitacionff 
==ff 
nullff !
)ff! "
returnff# )

BadRequestff* 4
(ff4 5
)ff5 6
;ff6 7
ifgg 
(gg 

habitaciongg 
.gg 
PrecioPorNochegg )
<gg* +
$numgg, -
)gg- .
returngg/ 5

BadRequestgg6 @
(gg@ A
$strggA l
)ggl m
;ggm n
ifhh 
(hh 

habitacionhh 
.hh 
tipohh 
==hh  "
nullhh# '
)hh' (
returnhh) /

BadRequesthh0 :
(hh: ;
$strhh; d
)hhd e
;hhe f

habitacionii 
.ii 

Disponibleii !
=ii" #
trueii$ (
;ii( )
_appDBcontextkk 
.kk 
Habitacioneskk &
.kk& '
Addkk' *
(kk* +

habitacionkk+ 5
)kk5 6
;kk6 7
awaitll 
_appDBcontextll 
.ll  
SaveChangesAsyncll  0
(ll0 1
)ll1 2
;ll2 3
returnmm 
Okmm 
(mm 

habitacionmm  
)mm  !
;mm! "
}nn 	
[pp 	
HttpPutpp	 
(pp 
$strpp 
)pp 
]pp 
publicqq 
asyncqq 
Taskqq 
<qq 
IActionResultqq '
>qq' (
PutHabitacionqq) 6
(qq6 7
intqq7 :
idqq; =
,qq= >
AppDBContextqq? K
.qqK L

HabitacionqqL V

habitacionqqW a
)qqa b
{rr 	
iftt 
(tt 

habitaciontt 
==tt 
nulltt "
)tt" #
returntt$ *

BadRequesttt+ 5
(tt5 6
)tt6 7
;tt7 8
ifuu 
(uu 

habitacionuu 
.uu 
PrecioPorNocheuu )
<uu* +
$numuu, -
)uu- .
returnuu/ 5

BadRequestuu6 @
(uu@ A
$struuA l
)uul m
;uum n
ifvv 
(vv 

habitacionvv 
.vv 
tipovv 
==vv  "
nullvv# '
)vv' (
returnvv) /

BadRequestvv0 :
(vv: ;
$strvv; d
)vvd e
;vve f
varxx 
habitacionExistentexx #
=xx$ %
awaitxx& +
_appDBcontextxx, 9
.xx9 :
Habitacionesxx: F
.xxF G
	FindAsyncxxG P
(xxP Q
idxxQ S
)xxS T
;xxT U
ifyy 
(yy 
habitacionExistenteyy #
==yy$ &
nullyy' +
)yy+ ,
returnyy- 3
NotFoundyy4 <
(yy< =
$stryy= W
)yyW X
;yyX Y
habitacionExistente{{ 
.{{  
tipo{{  $
={{% &

habitacion{{' 1
.{{1 2
tipo{{2 6
;{{6 7
habitacionExistente|| 
.||  
PrecioPorNoche||  .
=||/ 0

habitacion||1 ;
.||; <
PrecioPorNoche||< J
;||J K
habitacionExistente}} 
.}}  

Disponible}}  *
=}}+ ,

habitacion}}- 7
.}}7 8

Disponible}}8 B
;}}B C
await
ÄÄ 
_appDBcontext
ÄÄ 
.
ÄÄ  
SaveChangesAsync
ÄÄ  0
(
ÄÄ0 1
)
ÄÄ1 2
;
ÄÄ2 3
return
ÅÅ 
Ok
ÅÅ 
(
ÅÅ !
habitacionExistente
ÅÅ )
)
ÅÅ) *
;
ÅÅ* +
}
ÇÇ 	
[
ÖÖ 	

HttpDelete
ÖÖ	 
(
ÖÖ 
$str
ÖÖ 
)
ÖÖ 
]
ÖÖ 
public
ÜÜ 
async
ÜÜ 
Task
ÜÜ 
<
ÜÜ 
IActionResult
ÜÜ '
>
ÜÜ' (
DeleteHabitacion
ÜÜ) 9
(
ÜÜ9 :
int
ÜÜ: =
id
ÜÜ> @
)
ÜÜ@ A
{
áá 	
var
àà 

habitacion
àà 
=
àà 
await
àà "
_appDBcontext
àà# 0
.
àà0 1
Habitaciones
àà1 =
.
àà= >
	FindAsync
àà> G
(
ààG H
id
ààH J
)
ààJ K
;
ààK L
if
ââ 
(
ââ 

habitacion
ââ 
==
ââ 
null
ââ "
)
ââ" #
return
ââ$ *
NotFound
ââ+ 3
(
ââ3 4
)
ââ4 5
;
ââ5 6
_appDBcontext
ãã 
.
ãã 
Habitaciones
ãã &
.
ãã& '
Remove
ãã' -
(
ãã- .

habitacion
ãã. 8
)
ãã8 9
;
ãã9 :
await
åå 
_appDBcontext
åå 
.
åå  
SaveChangesAsync
åå  0
(
åå0 1
)
åå1 2
;
åå2 3
return
çç 
Ok
çç 
(
çç 
$"
çç 
$str
çç .
{
çç. /

habitacion
çç/ 9
.
çç9 :
id
çç: <
}
çç< =
"
çç= >
)
çç> ?
;
çç? @
}
éé 	
}
êê 
[
íí 
ApiController
íí 
]
íí 
[
ìì 
Route
ìì 

(
ìì
 
$str
ìì 
)
ìì 
]
ìì 
public
îî 

class
îî  
ReservasController
îî #
:
îî$ %
ControllerBase
îî& 4
{
ïï 
private
ññ 
readonly
ññ 
AppDBContext
ññ %
_appDBcontext
ññ& 3
;
ññ3 4
public
òò  
ReservasController
òò !
(
òò! "
AppDBContext
òò" .
context
òò/ 6
)
òò6 7
{
ôô 	
_appDBcontext
öö 
=
öö 
context
öö #
;
öö# $
}
õõ 	
[
ùù 	
HttpGet
ùù	 
]
ùù 
public
ûû 
async
ûû 
Task
ûû 
<
ûû 
IActionResult
ûû '
>
ûû' (
GetReservas
ûû) 4
(
ûû4 5
)
ûû5 6
{
üü 	
var
†† 
reservas
†† 
=
†† 
await
††  
_appDBcontext
††! .
.
††. /
Reservas
††/ 7
.
††7 8
ToListAsync
††8 C
(
††C D
)
††D E
;
††E F
return
°° 
Ok
°° 
(
°° 
reservas
°° 
)
°° 
;
°°  
}
¢¢ 	
[
§§ 	
HttpGet
§§	 
(
§§ 
$str
§§ 
)
§§ 
]
§§ 
public
•• 
async
•• 
Task
•• 
<
•• 
ActionResult
•• &
<
••& '
AppDBContext
••' 3
.
••3 4
Reserva
••4 ;
>
••; <
>
••< =

GetReserva
••> H
(
••H I
int
••I L
id
••M O
)
••O P
{
¶¶ 	
var
ßß 
reserva
ßß 
=
ßß 
await
ßß 
_appDBcontext
ßß  -
.
ßß- .
Reservas
ßß. 6
.
ßß6 7
	FindAsync
ßß7 @
(
ßß@ A
id
ßßA C
)
ßßC D
;
ßßD E
if
®® 
(
®® 
reserva
®® 
==
®® 
null
®® 
)
®®  
return
®®! '
NotFound
®®( 0
(
®®0 1
)
®®1 2
;
®®2 3
return
©© 
reserva
©© 
;
©© 
}
™™ 	
[
¨¨ 	
HttpPost
¨¨	 
]
¨¨ 
public
≠≠ 
async
≠≠ 
Task
≠≠ 
<
≠≠ 
ActionResult
≠≠ &
<
≠≠& '
AppDBContext
≠≠' 3
.
≠≠3 4
Reserva
≠≠4 ;
>
≠≠; <
>
≠≠< =
PostReserva
≠≠> I
(
≠≠I J
AppDBContext
≠≠J V
.
≠≠V W
Reserva
≠≠W ^
reserva
≠≠_ f
)
≠≠f g
{
ÆÆ 	
if
ØØ 
(
ØØ 
reserva
ØØ 
.
ØØ 
fechaInicio
ØØ #
==
ØØ$ &
default
ØØ' .
||
ØØ/ 1
reserva
ØØ2 9
.
ØØ9 :
fechaFin
ØØ: B
==
ØØC E
default
ØØF M
)
ØØM N
return
∞∞ 

BadRequest
∞∞ !
(
∞∞! "
$str
∞∞" P
)
∞∞P Q
;
∞∞Q R
if
≤≤ 
(
≤≤ 
reserva
≤≤ 
.
≤≤ 
fechaFin
≤≤  
<=
≤≤! #
reserva
≤≤$ +
.
≤≤+ ,
fechaInicio
≤≤, 7
)
≤≤7 8
return
≥≥ 

BadRequest
≥≥ !
(
≥≥! "
$str
≥≥" X
)
≥≥X Y
;
≥≥Y Z
var
µµ 
cliente
µµ 
=
µµ 
await
µµ 
_appDBcontext
µµ  -
.
µµ- .
Clientes
µµ. 6
.
µµ6 7
	FindAsync
µµ7 @
(
µµ@ A
reserva
µµA H
.
µµH I
	clienteId
µµI R
)
µµR S
;
µµS T
if
∂∂ 
(
∂∂ 
cliente
∂∂ 
==
∂∂ 
null
∂∂ 
)
∂∂  
return
∑∑ 
NotFound
∑∑ 
(
∑∑  
$str
∑∑  D
)
∑∑D E
;
∑∑E F
var
ππ 

habitacion
ππ 
=
ππ 
await
ππ "
_appDBcontext
ππ# 0
.
ππ0 1
Habitaciones
ππ1 =
.
ππ= >
	FindAsync
ππ> G
(
ππG H
reserva
ππH O
.
ππO P
habitacionId
ππP \
)
ππ\ ]
;
ππ] ^
if
∫∫ 
(
∫∫ 

habitacion
∫∫ 
==
∫∫ 
null
∫∫ "
)
∫∫" #
return
ªª 
NotFound
ªª 
(
ªª  
$str
ªª  D
)
ªªD E
;
ªªE F
if
ΩΩ 
(
ΩΩ 
!
ΩΩ 

habitacion
ΩΩ 
.
ΩΩ 

Disponible
ΩΩ &
)
ΩΩ& '
return
ææ 

BadRequest
ææ !
(
ææ! "
$str
ææ" O
)
ææO P
;
ææP Q
_appDBcontext
¡¡ 
.
¡¡ 
Reservas
¡¡ "
.
¡¡" #
Add
¡¡# &
(
¡¡& '
reserva
¡¡' .
)
¡¡. /
;
¡¡/ 0

habitacion
¬¬ 
.
¬¬ 

Disponible
¬¬ !
=
¬¬" #
false
¬¬$ )
;
¬¬) *
await
√√ 
_appDBcontext
√√ 
.
√√  
SaveChangesAsync
√√  0
(
√√0 1
)
√√1 2
;
√√2 3
return
ƒƒ 
Ok
ƒƒ 
(
ƒƒ 
reserva
ƒƒ 
)
ƒƒ 
;
ƒƒ 
}
≈≈ 	
[
»» 	
HttpPut
»»	 
(
»» 
$str
»» 
)
»» 
]
»» 
public
…… 
async
…… 
Task
…… 
<
…… 
IActionResult
…… '
>
……' (

PutReserva
……) 3
(
……3 4
int
……4 7
id
……8 :
,
……: ;
AppDBContext
……< H
.
……H I
Reserva
……I P
reserva
……Q X
)
……X Y
{
   	
var
ÃÃ 
reservaExistente
ÃÃ  
=
ÃÃ! "
await
ÃÃ# (
_appDBcontext
ÃÃ) 6
.
ÃÃ6 7
Reservas
ÃÃ7 ?
.
ÃÃ? @
	FindAsync
ÃÃ@ I
(
ÃÃI J
id
ÃÃJ L
)
ÃÃL M
;
ÃÃM N
if
ÕÕ 
(
ÕÕ 
reservaExistente
ÕÕ  
==
ÕÕ! #
null
ÕÕ$ (
)
ÕÕ( )
return
ÕÕ* 0
NotFound
ÕÕ1 9
(
ÕÕ9 :
$str
ÕÕ: Q
)
ÕÕQ R
;
ÕÕR S
if
œœ 
(
œœ 
reserva
œœ 
.
œœ 
fechaInicio
œœ #
==
œœ$ &
default
œœ' .
||
œœ/ 1
reserva
œœ2 9
.
œœ9 :
fechaFin
œœ: B
==
œœC E
default
œœF M
)
œœM N
return
–– 

BadRequest
–– !
(
––! "
$str
––" P
)
––P Q
;
––Q R
if
““ 
(
““ 
reserva
““ 
.
““ 
fechaFin
““  
<=
““! #
reserva
““$ +
.
““+ ,
fechaInicio
““, 7
)
““7 8
return
”” 

BadRequest
”” !
(
””! "
$str
””" X
)
””X Y
;
””Y Z
if
’’ 
(
’’ 
reserva
’’ 
.
’’ 
precioTotal
’’ #
<
’’$ %
$num
’’& '
)
’’' (
return
÷÷ 

BadRequest
÷÷ !
(
÷÷! "
$str
÷÷" J
)
÷÷J K
;
÷÷K L
var
ÿÿ 
cliente
ÿÿ 
=
ÿÿ 
await
ÿÿ 
_appDBcontext
ÿÿ  -
.
ÿÿ- .
Clientes
ÿÿ. 6
.
ÿÿ6 7
	FindAsync
ÿÿ7 @
(
ÿÿ@ A
reserva
ÿÿA H
.
ÿÿH I
	clienteId
ÿÿI R
)
ÿÿR S
;
ÿÿS T
if
ŸŸ 
(
ŸŸ 
cliente
ŸŸ 
==
ŸŸ 
null
ŸŸ 
)
ŸŸ  
return
⁄⁄ 
NotFound
⁄⁄ 
(
⁄⁄  
$str
⁄⁄  D
)
⁄⁄D E
;
⁄⁄E F
var
‹‹ 

habitacion
‹‹ 
=
‹‹ 
await
‹‹ "
_appDBcontext
‹‹# 0
.
‹‹0 1
Habitaciones
‹‹1 =
.
‹‹= >
	FindAsync
‹‹> G
(
‹‹G H
reserva
‹‹H O
.
‹‹O P
habitacionId
‹‹P \
)
‹‹\ ]
;
‹‹] ^
if
›› 
(
›› 

habitacion
›› 
==
›› 
null
›› "
)
››" #
return
ﬁﬁ 
NotFound
ﬁﬁ 
(
ﬁﬁ  
$str
ﬁﬁ  D
)
ﬁﬁD E
;
ﬁﬁE F
reservaExistente
·· 
.
·· 
fechaFin
·· %
=
··& '
reserva
··( /
.
··/ 0
fechaFin
··0 8
;
··8 9
reservaExistente
‚‚ 
.
‚‚ 
fechaInicio
‚‚ (
=
‚‚) *
reserva
‚‚+ 2
.
‚‚2 3
fechaInicio
‚‚3 >
;
‚‚> ?
reservaExistente
„„ 
.
„„ 
	clienteId
„„ &
=
„„' (
reserva
„„) 0
.
„„0 1
	clienteId
„„1 :
;
„„: ;
reservaExistente
‰‰ 
.
‰‰ 
habitacionId
‰‰ )
=
‰‰* +
reserva
‰‰, 3
.
‰‰3 4
habitacionId
‰‰4 @
;
‰‰@ A
reservaExistente
ÂÂ 
.
ÂÂ 
precioTotal
ÂÂ (
=
ÂÂ) *
reserva
ÂÂ+ 2
.
ÂÂ2 3
precioTotal
ÂÂ3 >
;
ÂÂ> ?
await
ËË 
_appDBcontext
ËË 
.
ËË  
SaveChangesAsync
ËË  0
(
ËË0 1
)
ËË1 2
;
ËË2 3
return
ÈÈ 
Ok
ÈÈ 
(
ÈÈ 
reservaExistente
ÈÈ &
)
ÈÈ& '
;
ÈÈ' (
}
ÍÍ 	
[
ÌÌ 	

HttpDelete
ÌÌ	 
(
ÌÌ 
$str
ÌÌ 
)
ÌÌ 
]
ÌÌ 
public
ÓÓ 
async
ÓÓ 
Task
ÓÓ 
<
ÓÓ 
IActionResult
ÓÓ '
>
ÓÓ' (
DeleteReserva
ÓÓ) 6
(
ÓÓ6 7
int
ÓÓ7 :
id
ÓÓ; =
)
ÓÓ= >
{
ÔÔ 	
var
 
reserva
 
=
 
await
 
_appDBcontext
  -
.
- .
Reservas
. 6
.
6 7
	FindAsync
7 @
(
@ A
id
A C
)
C D
;
D E
if
ÒÒ 
(
ÒÒ 
reserva
ÒÒ 
==
ÒÒ 
null
ÒÒ 
)
ÒÒ  
return
ÒÒ! '
NotFound
ÒÒ( 0
(
ÒÒ0 1
)
ÒÒ1 2
;
ÒÒ2 3
_appDBcontext
ÛÛ 
.
ÛÛ 
Reservas
ÛÛ "
.
ÛÛ" #
Remove
ÛÛ# )
(
ÛÛ) *
reserva
ÛÛ* 1
)
ÛÛ1 2
;
ÛÛ2 3
await
ÙÙ 
_appDBcontext
ÙÙ 
.
ÙÙ  
SaveChangesAsync
ÙÙ  0
(
ÙÙ0 1
)
ÙÙ1 2
;
ÙÙ2 3
return
ıı 
Ok
ıı 
(
ıı 
$"
ıı 
$str
ıı +
{
ıı+ ,
reserva
ıı, 3
.
ıı3 4
id
ıı4 6
}
ıı6 7
"
ıı7 8
)
ıı8 9
;
ıı9 :
}
ˆˆ 	
}
˜˜ 
[
˘˘ 
ApiController
˘˘ 
]
˘˘ 
[
˙˙ 
Route
˙˙ 

(
˙˙
 
$str
˙˙ 
)
˙˙ 
]
˙˙ 
public
˚˚ 

class
˚˚ ,
ServiciosAdicionalesController
˚˚ /
:
˚˚0 1
ControllerBase
˚˚2 @
{
¸¸ 
private
˝˝ 
readonly
˝˝ 
AppDBContext
˝˝ %
_appDBcontext
˝˝& 3
;
˝˝3 4
public
ˇˇ ,
ServiciosAdicionalesController
ˇˇ -
(
ˇˇ- .
AppDBContext
ˇˇ. :
context
ˇˇ; B
)
ˇˇB C
{
ÄÄ 	
_appDBcontext
ÅÅ 
=
ÅÅ 
context
ÅÅ #
;
ÅÅ# $
}
ÇÇ 	
[
ÖÖ 	
HttpGet
ÖÖ	 
]
ÖÖ 
public
ÜÜ 
async
ÜÜ 
Task
ÜÜ 
<
ÜÜ 
IActionResult
ÜÜ '
>
ÜÜ' (
GetServicios
ÜÜ) 5
(
ÜÜ5 6
)
ÜÜ6 7
{
áá 	
var
àà 
	servicios
àà 
=
àà 
await
àà !
_appDBcontext
àà" /
.
àà/ 0"
ServiciosAdicionales
àà0 D
.
ààD E
ToListAsync
ààE P
(
ààP Q
)
ààQ R
;
ààR S
return
ââ 
Ok
ââ 
(
ââ 
	servicios
ââ 
)
ââ  
;
ââ  !
}
ää 	
[
åå 	
HttpGet
åå	 
(
åå 
$str
åå 
)
åå 
]
åå 
public
çç 
async
çç 
Task
çç 
<
çç 
ActionResult
çç &
<
çç& '
AppDBContext
çç' 3
.
çç3 4
ServicioAdicional
çç4 E
>
ççE F
>
ççF G
GetServicio
ççH S
(
ççS T
int
ççT W
id
ççX Z
)
ççZ [
{
éé 	
var
èè 
servicio
èè 
=
èè 
await
èè  
_appDBcontext
èè! .
.
èè. /"
ServiciosAdicionales
èè/ C
.
èèC D
	FindAsync
èèD M
(
èèM N
id
èèN P
)
èèP Q
;
èèQ R
if
êê 
(
êê 
servicio
êê 
==
êê 
null
êê  
)
êê  !
return
êê" (
NotFound
êê) 1
(
êê1 2
)
êê2 3
;
êê3 4
return
ëë 
servicio
ëë 
;
ëë 
}
íí 	
[
îî 	
HttpPost
îî	 
]
îî 
public
ïï 
async
ïï 
Task
ïï 
<
ïï 
ActionResult
ïï &
<
ïï& '
AppDBContext
ïï' 3
.
ïï3 4
ServicioAdicional
ïï4 E
>
ïïE F
>
ïïF G
PostServicio
ïïH T
(
ïïT U
AppDBContext
ïïU a
.
ïïa b
ServicioAdicional
ïïb s
servicio
ïït |
)
ïï| }
{
ññ 	
var
óó 
reserva
óó 
=
óó 
await
óó 
_appDBcontext
óó  -
.
óó- .
Reservas
óó. 6
.
óó6 7
	FindAsync
óó7 @
(
óó@ A
servicio
óóA I
.
óóI J
	idReserva
óóJ S
)
óóS T
;
óóT U
if
òò 
(
òò 
reserva
òò 
==
òò 
null
òò 
)
òò  
return
ôô 
NotFound
ôô 
(
ôô  
$str
ôô  D
)
ôôD E
;
ôôE F
_appDBcontext
õõ 
.
õõ "
ServiciosAdicionales
õõ .
.
õõ. /
Add
õõ/ 2
(
õõ2 3
servicio
õõ3 ;
)
õõ; <
;
õõ< =
await
úú 
_appDBcontext
úú 
.
úú  
SaveChangesAsync
úú  0
(
úú0 1
)
úú1 2
;
úú2 3
return
ùù 
Ok
ùù 
(
ùù 
servicio
ùù 
)
ùù 
;
ùù  
}
ûû 	
[
†† 	
HttpPut
††	 
(
†† 
$str
†† 
)
†† 
]
†† 
public
°° 
async
°° 
Task
°° 
<
°° 
IActionResult
°° '
>
°°' (
PutServicio
°°) 4
(
°°4 5
int
°°5 8
id
°°9 ;
,
°°; <
AppDBContext
°°= I
.
°°I J
ServicioAdicional
°°J [
servicio
°°\ d
)
°°d e
{
¢¢ 	
var
§§ 
servicioExistente
§§ !
=
§§" #
await
§§$ )
_appDBcontext
§§* 7
.
§§7 8"
ServiciosAdicionales
§§8 L
.
§§L M
	FindAsync
§§M V
(
§§V W
id
§§W Y
)
§§Y Z
;
§§Z [
if
•• 
(
•• 
servicioExistente
•• !
==
••" $
null
••% )
)
••) *
return
••+ 1
NotFound
••2 :
(
••: ;
$str
••; S
)
••S T
;
••T U
var
ßß 
reserva
ßß 
=
ßß 
await
ßß 
_appDBcontext
ßß  -
.
ßß- .
Reservas
ßß. 6
.
ßß6 7
	FindAsync
ßß7 @
(
ßß@ A
servicio
ßßA I
.
ßßI J
	idReserva
ßßJ S
)
ßßS T
;
ßßT U
if
®® 
(
®® 
reserva
®® 
==
®® 
null
®® 
)
®®  
return
©© 
NotFound
©© 
(
©©  
$str
©©  D
)
©©D E
;
©©E F
servicioExistente
´´ 
.
´´ 
descripcion
´´ )
=
´´* +
servicio
´´, 4
.
´´4 5
descripcion
´´5 @
;
´´@ A
servicioExistente
¨¨ 
.
¨¨ 
costo
¨¨ #
=
¨¨$ %
servicio
¨¨& .
.
¨¨. /
costo
¨¨/ 4
;
¨¨4 5
servicioExistente
≠≠ 
.
≠≠ 
	idReserva
≠≠ '
=
≠≠( )
servicio
≠≠* 2
.
≠≠2 3
	idReserva
≠≠3 <
;
≠≠< =
await
∞∞ 
_appDBcontext
∞∞ 
.
∞∞  
SaveChangesAsync
∞∞  0
(
∞∞0 1
)
∞∞1 2
;
∞∞2 3
return
±± 
Ok
±± 
(
±± 
servicioExistente
±± '
)
±±' (
;
±±( )
}
≤≤ 	
[
µµ 	

HttpDelete
µµ	 
(
µµ 
$str
µµ 
)
µµ 
]
µµ 
public
∂∂ 
async
∂∂ 
Task
∂∂ 
<
∂∂ 
IActionResult
∂∂ '
>
∂∂' (
DeleteServicio
∂∂) 7
(
∂∂7 8
int
∂∂8 ;
id
∂∂< >
)
∂∂> ?
{
∑∑ 	
var
∏∏ 
servicio
∏∏ 
=
∏∏ 
await
∏∏  
_appDBcontext
∏∏! .
.
∏∏. /"
ServiciosAdicionales
∏∏/ C
.
∏∏C D
	FindAsync
∏∏D M
(
∏∏M N
id
∏∏N P
)
∏∏P Q
;
∏∏Q R
if
ππ 
(
ππ 
servicio
ππ 
==
ππ 
null
ππ  
)
ππ  !
return
ππ" (
NotFound
ππ) 1
(
ππ1 2
)
ππ2 3
;
ππ3 4
_appDBcontext
ªª 
.
ªª "
ServiciosAdicionales
ªª .
.
ªª. /
Remove
ªª/ 5
(
ªª5 6
servicio
ªª6 >
)
ªª> ?
;
ªª? @
await
ºº 
_appDBcontext
ºº 
.
ºº  
SaveChangesAsync
ºº  0
(
ºº0 1
)
ºº1 2
;
ºº2 3
return
ΩΩ 
Ok
ΩΩ 
(
ΩΩ 
$"
ΩΩ 
$str
ΩΩ ,
{
ΩΩ, -
servicio
ΩΩ- 5
.
ΩΩ5 6
id
ΩΩ6 8
}
ΩΩ8 9
"
ΩΩ9 :
)
ΩΩ: ;
;
ΩΩ; <
}
ææ 	
}
¿¿ 
}¡¡ ≈/
fD:\ESPE\SEXTO SEMESTRE\Pruebas Software\Parcial2\Programas\ReservasHotel\ReservasHotel\AppDBContext.cs
	namespace 	
ReservasHotel
 
{ 
public 

class 
AppDBContext 
: 
	DbContext  )
{		 
public

 
AppDBContext

 
(

 
DbContextOptions

 ,
<

, -
AppDBContext

- 9
>

9 :
options

; B
)

B C
:

D E
base

F J
(

J K
options

K R
)

R S
{

T U
}

V W
public 
DbSet 
< 
Cliente 
> 
Clientes &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 
DbSet 
< 

Habitacion 
>  
Habitaciones! -
{. /
get0 3
;3 4
set5 8
;8 9
}: ;
public 
DbSet 
< 
Reserva 
> 
Reservas &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 
DbSet 
< 
ServicioAdicional &
>& ' 
ServiciosAdicionales( <
{= >
get? B
;B C
setD G
;G H
}I J
public 
class 
Cliente 
{ 	
public 
int 
? 
id 
{ 
get  
;  !
set" %
;% &
}' (
public 
required 
string "
nombre# )
{* +
get, /
;/ 0
set1 4
;4 5
}6 7
public 
required 
string "
apellido# +
{, -
get. 1
;1 2
set3 6
;6 7
}8 9
public 
string 
? 
telefono #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
ICollection 
< 
Reserva &
>& '
?' (
reservas) 1
{2 3
get4 7
;7 8
set9 <
;< =
}> ?
} 	
public 
class 

Habitacion 
{   	
public!! 
int!! 
?!! 
id!! 
{!! 
get!!  
;!!  !
set!!" %
;!!% &
}!!' (
public## 
required## 
string## "
tipo### '
{##( )
get##* -
;##- .
set##/ 2
;##2 3
}##4 5
[%% 
Column%% 
(%% 
TypeName%% 
=%% 
$str%% .
)%%. /
]%%/ 0
public&& 
required&& 
decimal&& #
PrecioPorNoche&&$ 2
{&&3 4
get&&5 8
;&&8 9
set&&: =
;&&= >
}&&? @
public(( 
required(( 
bool((  

Disponible((! +
{((, -
get((. 1
;((1 2
set((3 6
;((6 7
}((8 9
public++ 
ICollection++ 
<++ 
Reserva++ &
>++& '
?++' (
reservas++) 1
{++2 3
get++4 7
;++7 8
set++9 <
;++< =
}++> ?
},, 	
public.. 
class.. 
Reserva.. 
{// 	
public00 
int00 
?00 
id00 
{00 
get00  
;00  !
set00" %
;00% &
}00' (
public22 
required22 
DateTime22 $
fechaInicio22% 0
{221 2
get223 6
;226 7
set228 ;
;22; <
}22= >
public44 
required44 
DateTime44 $
fechaFin44% -
{44. /
get440 3
;443 4
set445 8
;448 9
}44: ;
public66 
required66 
int66 
	clienteId66  )
{66* +
get66, /
;66/ 0
set661 4
;664 5
}666 7
public88 
required88 
int88 
habitacionId88  ,
{88- .
get88/ 2
;882 3
set884 7
;887 8
}889 :
[:: 
Column:: 
(:: 
TypeName:: 
=:: 
$str:: .
)::. /
]::/ 0
public;; 
required;; 
decimal;; #
precioTotal;;$ /
{;;0 1
get;;2 5
;;;5 6
set;;7 :
;;;: ;
};;< =
public== 
ICollection== 
<== 
ServicioAdicional== 0
>==0 1
?==1 2 
serviciosAdicionales==3 G
{==H I
get==J M
;==M N
set==O R
;==R S
}==T U
}>> 	
publicAA 
classAA 
ServicioAdicionalAA &
{BB 	
publicCC 
intCC 
?CC 
idCC 
{CC 
getCC  
;CC  !
setCC" %
;CC% &
}CC' (
publicEE 
requiredEE 
stringEE "
descripcionEE# .
{EE/ 0
getEE1 4
;EE4 5
setEE6 9
;EE9 :
}EE; <
[GG 
ColumnGG 
(GG 
TypeNameGG 
=GG 
$strGG .
)GG. /
]GG/ 0
publicHH 
requiredHH 
decimalHH #
costoHH$ )
{HH* +
getHH, /
;HH/ 0
setHH1 4
;HH4 5
}HH6 7
publicJJ 
requiredJJ 
intJJ 
	idReservaJJ  )
{JJ* +
getJJ, /
;JJ/ 0
setJJ1 4
;JJ4 5
}JJ6 7
}KK 	
}NN 
}OO 